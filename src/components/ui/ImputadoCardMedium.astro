---
import BadgeLight from './BadgeLight.astro';
import BadgeOutline from './BadgeOutline.astro';

interface Props {
  initials: string;
  name: string;
  role: string;
  badge: string;
  badgeType?: 'light' | 'outline';
  datoLabel?: string;
  dato?: string;
  variant?: 'light' | 'dark' | 'dark-alt';
  class?: string;
}

const {
  initials,
  name,
  role,
  badge,
  badgeType = 'light',
  datoLabel,
  dato,
  variant = 'dark',
  class: className = '',
} = Astro.props;

const variantStyles = {
  light: {
    bg: 'bg-white',
    initials: 'text-trama-100',
    name: 'text-black',
    role: 'text-trama-500',
    datoLabel: 'text-trama-red',
    dato: 'text-black',
  },
  dark: {
    bg: 'bg-trama-950',
    initials: 'text-trama-900',
    name: 'text-white',
    role: 'text-trama-500',
    datoLabel: 'text-trama-red',
    dato: 'text-white',
  },
  'dark-alt': {
    bg: 'bg-trama-850',
    initials: 'text-trama-900',
    name: 'text-white',
    role: 'text-trama-500',
    datoLabel: 'text-trama-red',
    dato: 'text-white',
  },
};

const styles = variantStyles[variant];

// Split name by newline for multi-line display
const nameLines = name.split('\n');
---

<div
  class:list={[
    "relative overflow-hidden h-80",
    styles.bg,
    className
  ]}
  data-imputados-card
>
  <!-- Background Initials -->
  <span
    class:list={[
      "absolute text-[200px] font-black select-none pointer-events-none",
      styles.initials
    ]}
    style="right: -20px; bottom: -60px; line-height: 1;"
  >
    {initials}
  </span>

  <!-- Content -->
  <div class="relative z-10 flex flex-col gap-2 p-6 w-[280px]">
    <!-- Name -->
    <div class="flex flex-col leading-none">
      {nameLines.map((line) => (
        <span class:list={["text-[28px] font-black", styles.name]}>
          {line}
        </span>
      ))}
    </div>

    <!-- Role -->
    <p class:list={["text-xs leading-snug whitespace-pre-line", styles.role]}>
      {role}
    </p>
  </div>

  <!-- Badge -->
  <div class="absolute left-6 top-[130px] z-10">
    {badgeType === 'light' && <BadgeLight text={badge} />}
    {badgeType === 'outline' && <BadgeOutline text={badge} />}
  </div>

  <!-- Dato Clave -->
  {(datoLabel || dato) && (
    <div class="absolute left-6 top-[180px] z-10 flex flex-col gap-1 max-w-[250px]">
      {datoLabel && (
        <span class:list={["text-[11px] font-semibold tracking-wider", styles.datoLabel]}>
          {datoLabel}
        </span>
      )}
      {dato && (
        <p class:list={["text-xs font-medium leading-snug", styles.dato]}>
          {dato}
        </p>
      )}
    </div>
  )}
</div>
